<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Jacques van Helden" />
  <meta name="date" content="2019-09-13" />
  <title>Premiers pas avec R</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <script src="01_intro_R_files/jquery-1.11.3/jquery.min.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="01_intro_R_files/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
  <script src="01_intro_R_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
  <script src="01_intro_R_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
  <script src="01_intro_R_files/bootstrap-3.3.5/shim/respond.min.js"></script>
  <link href="01_intro_R_files/slidy-2/styles/slidy.css" rel="stylesheet" />
  <script src="01_intro_R_files/slidy-2/scripts/slidy.js"></script>
</head>
<body>
<div class="slide titlepage">
  <h1 class="title">Premiers pas avec R</h1>
  <h1 class="subtitle">Probabilités et statistique pour la biologie (STAT1)</h1>
  <p class="author">
Jacques van Helden
  </p>
  <p class="date">2019-09-13</p>
</div>
<div id="but-de-ce-tutoriel" class="slide section level2">
<h1>But de ce tutoriel</h1>
<p>Le but de ce tutoriel est de décuvrir les éléments fondamentaux du langage de statistiques <strong><em>R</em></strong>.</p>
<p>Nous aborderons les éléments suivants:</p>
<ul>
<li><p>Manupulation de variables</p>
<ul>
<li>Assignation d’une valeur à une variable</li>
<li>Opérations basiques sur des nombres</li>
<li><p>Structures de base:</p>
<ul>
<li>vecteurs,</li>
<li>matrices</li>
<li>data.frames</li>
<li>listes</li>
</ul></li>
</ul></li>
<li><p>Fonctions</p></li>
<li><p>Graphiques</p></li>
<li><p>Distributions de probabilités</p></li>
</ul>
</div>
<div id="utiliser-r-comme-calculette" class="slide section level2">
<h1>Utiliser <strong><em>R</em></strong> comme calculette</h1>
<p><strong>Exemple:</strong> une addition avec R.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">5</span></a></code></pre></div>
<pre><code>[1] 7</code></pre>
<p>Le résultat affiché (<span class="math inline">\(7\)</span>) est précédé d’un indice (<span class="math inline">\([1]\)</span>). Nous verrons ultérieurement l’utilisation de ces indices.</p>
</div>
<div id="assignation-dune-valeur-a-une-variable" class="slide section level2">
<h1>Assignation d’une valeur à une variable</h1>
<p>En <strong><em>R</em></strong>, la combinaison de lettres “trait d’union” et “plus petit que” (<code>&lt;-</code>) indique qu’il faut assigner une valeur à une variable.</p>
<p>Ainsi, la commande suivante</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="dv">2</span></a></code></pre></div>
<ul>
<li>crée une variable nommée <span class="math inline">\(a\)</span>,</li>
<li>lui assigner la valeur <span class="math inline">\(2\)</span>,</li>
</ul>
<p>Le résultat peut être affiché avec la fonction R <code>print()</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">print</span>(a)</a></code></pre></div>
<pre><code>[1] 2</code></pre>
<p><strong>Remarque : </strong> R permet également d’utiliser le symbole “égale” (<code>=</code>) pour effectuer une assignation. Cependant, nous préférons utiliser l’opérateur explicite <code>&lt;-</code>, qui est également préconisé sur les <a href="https://google.github.io/styleguide/Rguide.html">recommandations de style</a>.</p>
</div>
<div id="conventions-de-notation-en-r" class="slide section level2">
<h1>Conventions de notation en R</h1>
<p>Il existe plusieurs conventions possibles pour les noms de variables, de fonction, les opérateurs, etc. Chaque langage de programmation a ses propres standards et recommandations. Pour ce cours nous suivons les recommandations de <strong>Google R style guide :</strong></p>
<p><a href="https://google.github.io/styleguide/Rguide.xml" class="uri">https://google.github.io/styleguide/Rguide.xml</a></p>
<p>Cependant, pour les <a href="https://google.github.io/styleguide/Rguide.xml#identifiers">identifiants de variables</a>, la notation <code>variable.name</code> est traditionnelle mais pose problème aux personnes familières avec les langages orientés objet, et nous admettons donc la notation alternative en “dos de chameau” de type <code>variableName</code>. Attention, par convention les noms de variables commencent toujours par une minuscule.</p>
</div>
<div id="calculer-avec-des-variables" class="slide section level2">
<h1>Calculer avec des variables</h1>
<ul>
<li>créer une variable nommée <span class="math inline">\(b\)</span> avec une valeur <span class="math inline">\(5\)</span>,</li>
<li>calculer <span class="math inline">\(a + b\)</span> et enregistrer le résultat dans une variable nommée <span class="math inline">\(c\)</span>,</li>
<li>imprimer le résultat.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">b &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">c &lt;-<span class="st"> </span>a <span class="op">+</span><span class="st"> </span>b</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="kw">print</span>(a)</a></code></pre></div>
<pre><code>[1] 2</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">print</span>(b)</a></code></pre></div>
<pre><code>[1] 5</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">print</span>(c)</a></code></pre></div>
<pre><code>[1] 7</code></pre>
</div>
<div id="assignation-neq-egalite" class="slide section level2">
<h1>Assignation <span class="math inline">\(\neq\)</span> égalité</h1>
<ul>
<li>remplacer la valeur de <span class="math inline">\(a\)</span> par <span class="math inline">\(3\)</span>,</li>
<li>imprimer la valeur de <span class="math inline">\(c\)</span></li>
<li>est-il toujours vrai que <span class="math inline">\(c = a + b\)</span> ? Pourquoi ?</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="dv">3</span> <span class="co">## Change the value of a</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw">print</span>(a)</a></code></pre></div>
<pre><code>[1] 3</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">print</span>(b)</a></code></pre></div>
<pre><code>[1] 5</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">print</span>(c)</a></code></pre></div>
<pre><code>[1] 7</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co">## Check whether c equals a + b</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2">c <span class="op">==</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>b</a></code></pre></div>
<pre><code>[1] FALSE</code></pre>
<p>Note: <strong><code>==</code></strong> indique qu’on teste si deux variables ont le même contenu. Le résultat est une valeur logique (TRUE ou FALSE).</p>
</div>
<div id="recalculer-un-resultat" class="slide section level2">
<h1>Recalculer un résultat</h1>
<p>Quand on change le contenu d’une variable <span class="math inline">\(a\)</span>, une autre variable (<span class="math inline">\(c\)</span>) préalablement calculées à partir de cette variable n’a aucune raison d’être recalculée si on ne le demande pas explicitement.</p>
<p><strong>Exemple:</strong></p>
<ul>
<li>remplacer la valeur de <span class="math inline">\(a\)</span> par <span class="math inline">\(27\)</span>,</li>
<li>recalculer et imprimer la valeur de <span class="math inline">\(c\)</span></li>
<li>tester l’égalité <span class="math inline">\(c = a + b\)</span></li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="dv">27</span> <span class="co">## Change the value of a</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2">c &lt;-<span class="st"> </span>a <span class="op">+</span><span class="st"> </span>b</a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="kw">print</span>(c) <span class="co">## Print the value of c</span></a></code></pre></div>
<pre><code>[1] 32</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="co">## Check whether c  equals a + b</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2">c <span class="op">==</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>b</a></code></pre></div>
<pre><code>[1] TRUE</code></pre>
</div>
<div id="vecteurs-de-valeurs" class="slide section level2">
<h1>Vecteurs de valeurs</h1>
<p>En <strong><em>R</em></strong>, la structure de données la plus simple est un <strong>vecteur</strong>.</p>
<ul>
<li><p>Dans l’exemple précédent, la variable <span class="math inline">\(a\)</span> ne contenait qu’un seul nombre, mais en pratique elle était stockée dans un vecteur à une seule entrée.</p></li>
<li><p>La fonction <code>print()</code> affiche les indices en début de lignes, ce qui est utile quand on affiche des vecteurs avec un grand nombre d’entrées.</p></li>
</ul>
<p><strong>Exemple:</strong> créer une variable nommée <strong><em>troisNombres</em></strong>, et l’initialiser avec un vecteur dont les valeurs sont <strong><em>27</em></strong>, <strong><em>12</em></strong> et <strong><em>3000</em></strong>.</p>
<p><strong>Trucs:</strong></p>
<ul>
<li>la fonction <code>c()</code> combine plusieurs valeurs en un vecteur.</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">troisNombres &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">27</span>,<span class="dv">12</span>,<span class="dv">3000</span>)</a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="kw">print</span>(troisNombres)</a></code></pre></div>
<pre><code>[1]   27   12 3000</code></pre>
</div>
<div id="series-de-nombres" class="slide section level2">
<h1>Séries de nombres</h1>
<p>La façon la plus simple de créer une série de nombre est d’utiliser le double point, qui génère toutes les valeurs entières entre deux limites.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">30</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="kw">print</span>(x)</a></code></pre></div>
<pre><code> [1]  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22
[24] 23 24 25 26 27 28 29 30</code></pre>
<p><strong>Note: </strong> si l’impression des valeurs du vecteur dépasse la largeur de la console, R passe à la ligne et affiche en début de ligne l’indice du premier élément.</p>
<p>Un autre exemple:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="kw">print</span>(<span class="dv">58</span><span class="op">:</span><span class="dv">157</span>)</a></code></pre></div>
<pre><code>  [1]  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72  73  74
 [18]  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90  91
 [35]  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107 108
 [52] 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125
 [69] 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142
 [86] 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157</code></pre>
</div>
<div id="calculer-avec-des-vecteurs" class="slide section level2">
<h1>Calculer avec des vecteurs</h1>
<p><strong>R</strong> permet de manipuler les vecteurs de façon extrêmement pratique. Une opération sur un vecteur s’applique automatiquement à tous ses éléments.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span> <span class="co"># Define a series from 1 to 10</span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="kw">print</span>(x)</a></code></pre></div>
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1">y &lt;-<span class="st"> </span>x<span class="op">^</span><span class="dv">2</span> <span class="co"># Compute the square of each number</span></a>
<a class="sourceLine" id="cb32-2" data-line-number="2"><span class="kw">print</span>(y)</a></code></pre></div>
<pre><code> [1]   1   4   9  16  25  36  49  64  81 100</code></pre>
</div>
<div id="sequences-de-nombres" class="slide section level2">
<h1>Séquences de nombres</h1>
<p>La fonction <code>seq()</code> permet de générer des séries de nombres séparés par un intervalle arbitraire.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="kw">seq</span>(<span class="dt">from=</span><span class="op">-</span><span class="dv">1</span>, <span class="dt">to=</span><span class="dv">1</span>, <span class="dt">by=</span><span class="fl">0.1</span>)</a></code></pre></div>
<pre><code> [1] -1.0 -0.9 -0.8 -0.7 -0.6 -0.5 -0.4 -0.3 -0.2 -0.1  0.0  0.1  0.2  0.3
[15]  0.4  0.5  0.6  0.7  0.8  0.9  1.0</code></pre>
</div>
<div id="les-variables-peuvent-contenir-du-texte" class="slide section level2">
<h1>Les variables peuvent contenir du texte</h1>
<p>Les variables ne se limitent pas aux nombres: elles peuvent contenir du texte (“chaînes de caractères”, “strings” en anglais).</p>
<p>Ici également, nous utilisons la fonction <code>c()</code> pour combiner plusieurs chaînes de caractères dans un vecteur.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="co"># The # symbol allows to insert comments in R code</span></a>
<a class="sourceLine" id="cb36-2" data-line-number="2"></a>
<a class="sourceLine" id="cb36-3" data-line-number="3"><span class="co"># Define  a vector named &quot;whoami&quot;, and </span></a>
<a class="sourceLine" id="cb36-4" data-line-number="4"><span class="co"># containing two names</span></a>
<a class="sourceLine" id="cb36-5" data-line-number="5">whoami &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Denis&quot;</span>, <span class="st">&quot;Siméon&quot;</span>)</a>
<a class="sourceLine" id="cb36-6" data-line-number="6"><span class="kw">print</span>(whoami) <span class="co"># Comment at the end of a line</span></a></code></pre></div>
<pre><code>[1] &quot;Denis&quot;  &quot;Siméon&quot;</code></pre>
</div>
<div id="concatenation-de-chaines-de-caracters" class="slide section level2">
<h1>Concaténation de chaînes de caractèrs</h1>
<p>La fonction <code>paste()</code> permet de concaténer les variables contenant du texte.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="co"># To concatenate the elements of a vector in a single chain, use &quot;collapse&quot;</span></a>
<a class="sourceLine" id="cb38-2" data-line-number="2">firstName &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="dt">collapse =</span> <span class="st">&quot; &quot;</span>, whoami)</a>
<a class="sourceLine" id="cb38-3" data-line-number="3"><span class="kw">print</span>(firstName)</a></code></pre></div>
<pre><code>[1] &quot;Denis Siméon&quot;</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="co"># TO concatenate two vectors, use &quot;sep&quot;</span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2">lastName &lt;-<span class="st"> &quot;Poisson&quot;</span></a>
<a class="sourceLine" id="cb40-3" data-line-number="3"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, firstName, lastName))</a></code></pre></div>
<pre><code>[1] &quot;Denis Siméon Poisson&quot;</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="co">## Concatenate 2 vectors with 3 values each</span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2">firstNames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;George&quot;</span>, <span class="st">&quot;Alfred&quot;</span>, <span class="st">&quot;Frédéric&quot;</span>)</a>
<a class="sourceLine" id="cb42-3" data-line-number="3">lastNames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Sand&quot;</span>,  <span class="st">&quot;Musset&quot;</span>, <span class="st">&quot;Chopin&quot;</span>)</a>
<a class="sourceLine" id="cb42-4" data-line-number="4">fullNames &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, firstNames, lastNames)</a>
<a class="sourceLine" id="cb42-5" data-line-number="5"><span class="kw">print</span>(fullNames)</a></code></pre></div>
<pre><code>[1] &quot;George Sand&quot;     &quot;Alfred Musset&quot;   &quot;Frédéric Chopin&quot;</code></pre>
<p>Notez que la fonction <code>paste()</code> peut aussi s’utiliser pour concaténer toutes les valeurs d’un vecteur, mais ceci requiert de définir l’argument <code>collapse</code> à la place de <code>sep</code>.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="kw">paste</span>(fullNames, <span class="dt">collapse =</span> <span class="st">&quot;, &quot;</span>)</a></code></pre></div>
<pre><code>[1] &quot;George Sand, Alfred Musset, Frédéric Chopin&quot;</code></pre>
</div>
<div id="fonctions-graphiques" class="slide section level2">
<h1>Fonctions graphiques</h1>
<p>R comporte un grand nombre de fonctions permettant de dessiner des graphiques simples ou élaborés. Nous allons explorer ici les méthodes les plus simples.</p>
</div>
<div id="nuage-de-points-scatter-plot" class="slide section level2">
<h1>Nuage de points (scatter plot)</h1>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-10</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb46-2" data-line-number="2">y &lt;-<span class="st"> </span>x<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb46-3" data-line-number="3"><span class="kw">plot</span>(x,y)</a></code></pre></div>
<p><img src="figures/scatter_plot-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="courbe-line-plot" class="slide section level2">
<h1>Courbe (line plot)</h1>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-10</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb47-2" data-line-number="2">y &lt;-<span class="st"> </span>x<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb47-3" data-line-number="3"><span class="kw">plot</span>(x,y, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="figures/line_plot-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="ameliorer-un-dessin" class="slide section level2">
<h1>Améliorer un dessin</h1>
<p><strong>Exercice: </strong> lisez l’aide de la fonction <code>plot()</code> en tapant <code>help(plot)</code>, et explorez les paramètres afin d’améliorer le graphique. Consultez également l’aide de la fonction <code>par()</code> (paramètres graphiques).</p>
<p>Vous pouvez par exemple ajouter les éléments suivants:</p>
<ul>
<li>titre</li>
<li>étiquettes des axes</li>
<li>coloration de la courbe</li>
<li>épaisseur de la courbe</li>
<li>grille</li>
<li>tracer une droite horizontale sur l’axe <span class="math inline">\(X=0\)</span></li>
<li>tracer une droite verticale sur l’axe <span class="math inline">\(Y=0\)</span></li>
<li>tout autre paramètre qui améliorera la lisibilité du résultat</li>
</ul>
<p>La solution se trouve sur la diapo suivante (ne regardez pas !).</p>
</div>
<div id="solution" class="slide section level2">
<h1>Solution</h1>
<p>Exécutez le bloc de code-ci-dessous pour afficher le résultat.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-10</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb48-2" data-line-number="2">y &lt;-<span class="st"> </span>x<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb48-3" data-line-number="3"><span class="kw">plot</span>(x,y, </a>
<a class="sourceLine" id="cb48-4" data-line-number="4">     <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="co"># Plot type</span></a>
<a class="sourceLine" id="cb48-5" data-line-number="5">     <span class="dt">main =</span> <span class="st">&quot;Parabole&quot;</span>, <span class="co"># Main title</span></a>
<a class="sourceLine" id="cb48-6" data-line-number="6">     <span class="dt">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="co">#X label</span></a>
<a class="sourceLine" id="cb48-7" data-line-number="7">     <span class="dt">ylab =</span> <span class="st">&quot;y = x^2&quot;</span>, <span class="co"># Y label</span></a>
<a class="sourceLine" id="cb48-8" data-line-number="8">     <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="co"># Curve color</span></a>
<a class="sourceLine" id="cb48-9" data-line-number="9">     <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="co"># Line width</span></a>
<a class="sourceLine" id="cb48-10" data-line-number="10">     <span class="dt">las =</span> <span class="dv">1</span> <span class="co"># display axis labels horizontally </span></a>
<a class="sourceLine" id="cb48-11" data-line-number="11">     )</a>
<a class="sourceLine" id="cb48-12" data-line-number="12"><span class="kw">grid</span>(<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">col=</span><span class="st">&quot;gray&quot;</span>) <span class="co"># Grid</span></a>
<a class="sourceLine" id="cb48-13" data-line-number="13"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>) <span class="co"># Horizontal line</span></a>
<a class="sourceLine" id="cb48-14" data-line-number="14"><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">0</span>) <span class="co"># Vertical line</span></a></code></pre></div>
</div>
<div id="distributions-de-probabilites" class="slide section level2">
<h1>Distributions de probabilités</h1>
<p><strong>R</strong> fournit 4 fonctions pour chacune des des distributions de probabilité classiques.</p>
<p>Avant d’aller plus loin, lisez attentivement l’aide pour les fonctions associées à la distribution binomiale.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="kw">help</span>(<span class="st">&quot;Binomial&quot;</span>)</a></code></pre></div>
<p><strong>Questions:</strong></p>
<ol style="list-style-type: decimal">
<li>Quelle est la fonction R qui permet de calculer la fonction de masse de probabilité (également appelée “densité”) ?</li>
<li>Quelle fonction R correspond à la fonction de répartition (également appelée “fonction de distribution”) ?</li>
<li>A quoi sert la fonction <em>rbinom()</em> ?</li>
</ol>
</div>
<div id="graphe-de-la-binomiale" class="slide section level2">
<h1>Graphe de la binomiale</h1>
<p><strong>Exercice:</strong> en supposant des nucléotides équiprobables et indépendants, dessiner la distribution de probabilité du nombre d’adénines pour un oligonucléotide de taille 30.</p>
<ul>
<li>fonction de masse de la probabilité</li>
<li>fonction de répartition</li>
</ul>
<p>Dans les diapos suivantes, nous vous guidons pas à pas pour débuter l’exercice, et vous pourrez ensuite améliorer le résultat à vote guise.</p>
</div>
<div id="formule-de-la-solution" class="slide section level2">
<h1>Formule de la solution</h1>
<p>Le nombre d’adénines peut prendre n’importe quelle valeur entre <span class="math inline">\(0\)</span> et <span class="math inline">\(30\)</span>. On peut modéliser le problème comme un schéma de Bernoulli avec <span class="math inline">\(n=30\)</span> essais pouvant chacun résulter en un succès (une adénine) avec une probabilité <span class="math inline">\(p=0.25\)</span>, ou un échec (tout autre nucléotide), avec une probabilité <span class="math inline">\(q = 1-p = 0.75\)</span>.</p>
<p>La probabilité d’observer exactement <span class="math inline">\(x\)</span> adénine vaut donc.</p>
<p><span class="math display">\[P(X=x) = \binom{n}{x} p^x (1-p)^{n-x} = \frac{30!}{x!(30-x)!} \cdot 0.25^x \cdot 0.75^{n-x}\]</span> où <span class="math inline">\(x\)</span> peut prendre n’importe quelle valeur entre <span class="math inline">\(0\)</span> et <span class="math inline">\(30\)</span>.</p>
</div>
<div id="calcul-de-la-fonction-de-masse-de-probabilite" class="slide section level2">
<h1>Calcul de la fonction de masse de probabilité</h1>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="co">## Define all possible values for X</span></a>
<a class="sourceLine" id="cb50-2" data-line-number="2">n &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb50-3" data-line-number="3">x &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span>n</a>
<a class="sourceLine" id="cb50-4" data-line-number="4">p &lt;-<span class="st"> </span><span class="fl">0.25</span></a>
<a class="sourceLine" id="cb50-5" data-line-number="5"></a>
<a class="sourceLine" id="cb50-6" data-line-number="6"><span class="co">## Compute the binomial PMF</span></a>
<a class="sourceLine" id="cb50-7" data-line-number="7">pmf &lt;-<span class="st"> </span><span class="kw">dbinom</span>(<span class="dt">x =</span> x, <span class="dt">size =</span> n, <span class="dt">prob =</span> p)</a></code></pre></div>
</div>
<div id="sous-ensemble-des-valeurs-dun-vecteur" class="slide section level2">
<h1>Sous-ensemble des valeurs d’un vecteur</h1>
<p>Nous pouvons sélectionner les 5 premières valeurs de la variable <em>pmf</em> (qui correspondent aux nombres de succès <span class="math inline">\(x\)</span> allant de <span class="math inline">\(0\)</span> à <span class="math inline">\(4\)</span>) …</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1">pmf[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a></code></pre></div>
<pre><code>[1] 0.0001785821 0.0017858209 0.0086314677 0.0268534550 0.0604202738</code></pre>
<p>… ou les 4 dernières valeurs (<span class="math inline">\(x\)</span> allant de <span class="math inline">\(27\)</span> à <span class="math inline">\(30\)</span> succès).</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1">pmf[(n<span class="dv">-3</span>)<span class="op">:</span>n]</a></code></pre></div>
<pre><code>[1] 1.925374e-12 9.508019e-14 3.395721e-15 7.806256e-17</code></pre>
</div>
<div id="restriction-du-nombre-de-decimales" class="slide section level2">
<h1>Restriction du nombre de décimales</h1>
<p>La fonction <code>round()</code> arrondit un résultat à un nombre donné de décimales.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1"><span class="kw">round</span>(pmf, <span class="dt">digit=</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code> [1] 0.000 0.002 0.009 0.027 0.060 0.105 0.145 0.166 0.159 0.130 0.091
[12] 0.055 0.029 0.013 0.005 0.002 0.001 0.000 0.000 0.000 0.000 0.000
[23] 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000</code></pre>
<p>Pour des distributions de probabilités, on descend assez facilement à des valeurs très faibles, dont on désire connaître l’ordre de grandeur tout en affichant un nombre raisonnable de chiffres significatifs (ceux qui suivent la première décimale non nulle). Pour cela, il est plus pratique d’utiliser la fonction <code>signif()</code>.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1"><span class="kw">signif</span>(pmf, <span class="dt">digit=</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code> [1] 1.79e-04 1.79e-03 8.63e-03 2.69e-02 6.04e-02 1.05e-01 1.45e-01
 [8] 1.66e-01 1.59e-01 1.30e-01 9.09e-02 5.51e-02 2.91e-02 1.34e-02
[15] 5.43e-03 1.93e-03 6.03e-04 1.66e-04 3.99e-05 8.39e-06 1.54e-06
[22] 2.44e-07 3.33e-08 3.86e-09 3.75e-10 3.00e-11 1.93e-12 9.51e-14
[29] 3.40e-15 7.81e-17 8.67e-19</code></pre>
</div>
<div id="dessin-de-la-distribution-binomiale" class="slide section level2">
<h1>Dessin de la distribution binomiale</h1>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1">n &lt;-<span class="st"> </span><span class="dv">30</span>; x &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span>n   <span class="co"># Define the X values from 0 to 14</span></a>
<a class="sourceLine" id="cb59-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="kw">dbinom</span>(<span class="dt">x =</span> x, <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="fl">0.25</span>) <span class="co"># Poisson density</span></a>
<a class="sourceLine" id="cb59-3" data-line-number="3"><span class="kw">plot</span>(x,y) <span class="co"># Check the result</span></a></code></pre></div>
<p><img src="figures/dbinom_plot-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Ce premier dessin n’est pas très élégant. Les points ne se détachent pas très bien du fond. Nous allons améliorer ce dessin.</p>
</div>
<div id="exercice-1-ameliorer-le-dessin-de-la-binomiale" class="slide section level2">
<h1>Exercice 1 : améliorer le dessin de la binomiale</h1>
<p>Utilisez les différentes option de la fonction <code>plot()</code> pour mieux mettre en évidence la forme de la distribution (résultat attendu sur la diapo suivante).</p>
<ul>
<li><p>Commencez par choisir un type de points (option <code>type</code>) qui donne l’impression de la hauteur de la probabilité (valeur <span class="math inline">\(Y\)</span>) correspondant à chaque point de l’axe <span class="math inline">\(X\)</span>.</p></li>
<li><p>Ajoutez un titre (option <code>main</code>) et adaptez les légendes aux axes (options <code>xlab</code>et <code>ylab</code>)</p></li>
<li><p>Colorez le dessin (option <code>col</code>)</p></li>
<li><p>Epaississez les traits (option <code>lwd</code>)</p></li>
<li><p>Ajoutez une grille horizontale (fonction <code>grid()</code>)</p></li>
<li><p>Assurez-vous que les étiquettes des axes soient toutes horizontales (option <code>las</code>).</p></li>
</ul>
</div>
<div id="resultat-attendu" class="slide section level2">
<h1>Résultat attendu</h1>
<p><img src="figures/dbinom_plot_improved-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="exercice-serie-de-courbes-binomiales" class="slide section level2">
<h1>Exercice: série de courbes binomiales</h1>
<p>Dessinez une série de courbes binomiales avec <span class="math inline">\(n=30\)</span> essais, et des valeurs de <span class="math inline">\(p\)</span> allant de <span class="math inline">\(0.1\)</span> à <span class="math inline">\(0.9\)</span> par pas de <span class="math inline">\(0.1\)</span>.</p>
<p><img src="figures/binomial_series-1.png" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div id="exercice-convergence-de-la-binomiale-vers-une-normale" class="slide section level2">
<h1>Exercice: convergence de la binomiale vers une normale</h1>
<p><img src="figures/unnamed-chunk-19-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="avant-de-terminer-conservez-la-trace-de-votre-session" class="slide section level2">
<h1>Avant de terminer : conservez la trace de votre session</h1>
<p>La traçabilité et la reproductibilité des analyses constituent un enjeu essentiel en sciences. La fonction <strong><em>R</em></strong> <code>sessionInfo()</code> fournit un résumé des conditions d’une session de travail: version de R, système opérateur, bibliothèques de fonctions utilisées.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>R version 3.6.1 (2019-07-05)
Platform: x86_64-apple-darwin15.6.0 (64-bit)
Running under: macOS High Sierra 10.13.6

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] knitr_1.23

loaded via a namespace (and not attached):
 [1] compiler_3.6.1  magrittr_1.5    tools_3.6.1     htmltools_0.3.6
 [5] yaml_2.2.0      Rcpp_1.0.2      stringi_1.4.3   rmarkdown_1.14 
 [9] stringr_1.4.0   xfun_0.8        digest_0.6.20   evaluate_0.14  </code></pre>
</div>

  <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
      var script = document.createElement("script");
      script.type = "text/javascript";
      script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
      document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>

</body>
</html>
